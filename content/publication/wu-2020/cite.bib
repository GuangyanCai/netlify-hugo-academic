@article{wu2020,
 abstract = {Recent work has developed analytic formulae for spherical harmonic (SH) coefficients from uniform polygonal lights, enabling near-field area lights to be included in Precomputed Radiance Transfer (PRT) systems, and in offline rendering. However, the method is inefficient since coefficients need to be recomputed at each vertex or shading point, for each light, even though the SH coefficients vary smoothly in space. The complexity scales linearly with the number of lights, making many-light rendering difficult. In this paper, we develop a novel analytic formula for the spatial gradients of the spherical harmonic coefficients for uniform polygonal area lights. The result is a significant generalization, involving the Reynolds transport theorem to reduce the problem to a boundary integral for which we derive a new analytic formula, showing how to reduce a key term to an earlier recurrence for SH coefficients. The implementation requires only minor additions to existing code for SH coefficients. The results also hold implications for recent efforts on differentiable rendering. We show that SH gradients enable very sparse spatial sampling, followed by accurate Hermite interpolation. This enables scaling PRT to hundreds of area lights with minimal overhead and real-time frame rates. Moreover, the SH gradient formula is a new mathematical result that potentially enables many other graphics applications.},
 address = {New York, NY, USA},
 articleno = {134},
 author = {Wu, Lifan and Cai, Guangyan and Zhao, Shuang and Ramamoorthi, Ravi},
 doi = {10.1145/3386569.3392373},
 issn = {0730-0301},
 issue_date = {August 2020},
 journal = {ACM Trans. Graph.},
 keywords = {area lighting, differentiable rendering, analytic gradients, spherical harmonics},
 month = {aug},
 number = {4},
 numpages = {14},
 publisher = {Association for Computing Machinery},
 title = {Analytic Spherical Harmonic Gradients for Real-Time Rendering with Many Polygonal Area Lights},
 url = {https://doi.org/10.1145/3386569.3392373},
 volume = {39},
 year = {2020}
}

